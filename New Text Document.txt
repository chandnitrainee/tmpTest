USE [VrindiAttendance]
GO
/****** Object:  StoredProcedure [dbo].[Attendance_sp_get_StoreUserCurrentStatus]    Script Date: 10/24/2015 21:58:20 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		Pankaj
-- Create date: 10-16-2015
-- Description: Fetches Latest user entry of specific store.
-- =============================================
ALTER PROCEDURE [dbo].[Attendance_sp_get_StoreUserCurrentStatus]
     @MasterAccountStoreID uniqueidentifier
	,@date DateTime
AS
BEGIN


Select wt_storeEmployee.user_fullname as "EmployeeName",Max(wt_Store_User_Entry.entryDateTime)as "LastEntryTime",Max(wt_Store_User_Entry.totalHoursWork)as "totalHoursWork",Max(wt_Store_User_Entry.totalBreakHours)as "totalBreakHours"
from wt_Store_User_Entry Right outer join  wt_storeEmployee
on wt_storeEmployee.user_id=wt_Store_User_Entry.user_id
where wt_Store_User_Entry.store_id=@MasterAccountStoreID and DATEDIFF(day,wt_Store_User_Entry.entrydatetime,@date)=0
group by wt_Store_User_Entry.user_id,wt_Store_User_Entry.store_id,wt_storeEmployee.user_fullname



END
